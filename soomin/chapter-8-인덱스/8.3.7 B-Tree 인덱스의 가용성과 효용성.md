---
type: 카테고리 (DB인지, 영어인지, 일기인지 등등)
source:
  - 공부한 내용의 근원지
tags:
  - cs
created: 2025-05-28
---

### Relevace Framing 🧩

**`부모 글` : [[B-Tree 인덱스]]**

# 0. 학습 목적

### 컬럼 순서에 따른 성능 차이

`다중 컬럼 인덱스`에서 각 컬럼의 순서와 그 컬럼에 사용된 조건이 동등 비교("=")인지 크다(">") 또는 작다("<") 같은 범위 조건인지에 따라 각 인덱스 컬럼의 활용 형태가 달라지며, 그 효율 또한 달라진다.

#### 케이스 A: INDEX(dept_no, emp_no)

```sql
SELECT * FROM dept_emp
WHERE dept_no = 'd002' AND emp_no >= 10144;
```

- **스캔 방식**: dept_no 조건으로 범위 확정 후 순차 스캔
- **효율성**: 'd002' 범위만 탐색하고 종료
- **읽는 데이터**: 필요한 범위만 정확히 스캔
- **성능**: 최적화된 인덱스 활용

#### 케이스 B: INDEX(emp_no, dept_no)

```sql
SELECT * FROM dept_emp
WHERE dept_no = 'd002' AND emp_no >= 10144;
```

- **스캔 방식**: emp_no 조건으로 시작점 찾고 전체 범위 탐색
- **효율성**: 모든 레코드에 대해 dept_no 조건 검사
- **읽는 데이터**: 불필요한 데이터까지 스캔
- **성능**: 비효율적인 인덱스 활용

### 조건 유형별 인덱스 활용도

#### 동등 비교 조건 (=)

- **특징**: 정확한 값 매칭
- **효율성**: 높은 선택도
- **활용**: 인덱스 범위 명확하게 제한
- **권장**: 다중 컬럼 인덱스 앞쪽 배치

#### 범위 비교 조건 (>, <, >=, <=)

- **특징**: 범위 내 값 매칭
- **효율성**: 중간 선택도
- **활용**: 범위 스캔 수행
- **권장**: 동등 조건 뒤에 배치

## 인덱스 가용성 제약사항

### B-Tree 인덱스 정렬 특성

- **기본 원리**: 왼쪽 값 기준 오른쪽 값 정렬
- **순서 의존성**: 선행 컬럼 조건 없이 후행 컬럼만 사용 불가
- **연속성**: 중간 컬럼 누락 시 그 이후 컬럼 활용 불가

### 인덱스 활용 불가능한 경우

#### 문자열 후방 매칭

```sql
-- 인덱스: INDEX(first_name)
SELECT * FROM employees WHERE first_name LIKE '%mer';
```

- **문제점**: 뒤쪽 패턴 매칭으로 시작점 특정 불가
- **대안**: 전문 검색 인덱스 활용
- **해결**: 역순 인덱스 또는 추가 컬럼 활용

#### 선행 컬럼 누락

```sql
-- 인덱스: INDEX(dept_no, emp_no)
SELECT * FROM dept_emp WHERE emp_no >= 10144;
```

- **문제점**: 선행 컬럼 dept_no 조건 없음
- **결과**: 인덱스 레인지 스캔 불가
- **해결**: 컬럼 순서 변경 또는 별도 인덱스 생성

## 인덱스 설계 최적화

### 다중 컬럼 인덱스 컬럼 순서 결정

1. **동등 조건 컬럼**: 가장 앞쪽 배치
2. **범위 조건 컬럼**: 동등 조건 뒤 배치
3. **선택도 높은 컬럼**: 우선 배치
4. **자주 사용되는 컬럼**: 앞쪽 배치

### 효율적인 인덱스 구성

```sql
-- 권장: 동등 조건 우선 배치
CREATE INDEX ix_optimal ON dept_emp (dept_no, emp_no);

-- 비권장: 범위 조건 우선 배치
CREATE INDEX ix_suboptimal ON dept_emp (emp_no, dept_no);
```

## 실무 적용 가이드

### 쿼리 패턴 분석

- **WHERE 절 조건**: 동등/범위 조건 분류
- **사용 빈도**: 자주 사용되는 조건 우선
- **선택도**: 데이터 분포 고려
- **조합 패턴**: 복합 조건 사용 빈도 분석

### 인덱스 성능 검증

- **실행 계획**: 인덱스 사용 방식 확인
- **스캔 범위**: 읽는 데이터 양 측정
- **비용 분석**: 인덱스 스캔 vs 풀 스캔 비교
- **성능 테스트**: 실제 데이터로 성능 검증

### 모니터링 포인트

- **인덱스 사용률**: 생성된 인덱스 활용도 측정
- **스캔 효율성**: 읽은 데이터 대비 사용된 데이터 비율
- **쿼리 성능**: 응답 시간 및 처리량 모니터링
- **리소스 사용량**: CPU, 메모리, 디스크 I/O 사용량

## 최적화 체크리스트

### 인덱스 생성 전 확인사항

- 주요 쿼리의 WHERE 조건 분석
- 컬럼별 선택도 및 카디널리티 확인
- 기존 인덱스와의 중복성 검토
- 유지보수 비용 고려

### 성능 최적화 전략

- 커버링 인덱스 활용
- 인덱스 힌트 적절한 사용
- 파티셔닝과 인덱스 조합
- 정기적인 인덱스 통계 갱신

---

# Metadata

### A. 모르는 단어 정리 to Layman's term

###  B. 참고 문서

### C. 자식 글

```dataview
TABLE without id file.inlinks AS "BackLink"
WHERE file.path = this.file.path
```
